#!/usr/bin/env php
<?php

use Illuminate\Container\Container;
use PhpLab\Core\Legacy\Yii\Helpers\FileHelper;
use Symfony\Component\Console\Application;
use Psr\Container\ContainerInterface;
use PhpLab\Core\Libs\Env\DotEnvHelper;
use PhpLab\Core\Console\Helpers\CommandHelper;

/** @var ContainerInterface $container */

require_once __DIR__ . '/../src/Bootstrap/autoload.php';
$rootPath = realpath(__DIR__ . '/..');
DotEnvHelper::init($rootPath);
$container = Container::getInstance();

FileHelper::save(__DIR__ . '/../var/testConsole/' . date('Y_m_d H_i_s') . '.json', json_encode($_SERVER, JSON_PRETTY_PRINT));

include __DIR__ . '/../config/bootstrap.php';

$consoleConfig = include __DIR__ . '/../config/console.php';
CommandHelper::registerFromNamespaceList($consoleConfig['namespaceList'], $container);

$application = $container->get(Application::class);
$application->run();
